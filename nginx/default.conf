server {
    listen 80 default_server;
    server_name _;
    root /usr/share/nginx/html;
    index index.html;

    # Root: try real file, then directory index, then SPA root
    location / {
        try_files $uri $uri/index.html /index.html;
    }

    # Exact match ensures /hugo/ serves its index without ambiguity
    location = /hugo/ {
        try_files /hugo/index.html =404;
    }

    # Subsites: safe order to avoid 403s for directory requests
    location ^~ /jekyll/ {
        try_files $uri $uri/index.html /jekyll/index.html;
        autoindex off;
    }
    location ^~ /hugo/ {
        try_files $uri $uri/index.html /hugo/index.html;
        autoindex off;
    }
    location ^~ /eleventy/ {
        try_files $uri $uri/index.html /eleventy/index.html;
        autoindex off;
    }
    location ^~ /astro/ {
        try_files $uri $uri/index.html /astro/index.html;
        autoindex off;
    }
}
